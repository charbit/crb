\documentclass[a4paper, 12pt]{report}
%================================================================
\usepackage{color,amsmath,amsfonts,amssymb,epsfig,hyperref}
\usepackage{graphicx}
\usepackage{dsfont}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{pdfpages}
%====================================
 \textheight 22cm
% \doublespace
  \oddsidemargin -0.5cm
  \evensidemargin +1.5cm
  \textwidth 15cm
 \topmargin 0cm
%============================================
% Figures
%============================================
\newcommand{\figsstit}[2]{
\begin{figure}[hbtp]
\centerline{
    \hbox{ \includegraphics[scale=#2]{#1} }
}
\end{figure}}
%============================================
\newcommand{\figscale}[4]{
\begin{figure}[hbtp]
\centerline{
    \hbox{ \includegraphics[scale=#4]{#1} }
}
\begin{center}
\parbox{12 cm}
{
    \caption{\protect\small\it  {#2}}
    \label {#3}
}
\end{center}

\end{figure}}

%==================================================
\newcommand\algo[1]%
{
    \begin{center} %
    \begin{tabular} {||p{10 cm}l ||}%
    \hline
               #1 &  \\
    \hline
    \end{tabular}
    \vspace{12pt}
    \end{center}
}


%==============================================
\newcommand{\prob}[1]{\mathds{P}\left( #1 \right)}
\newcommand{\esp}[1]{\mathds{E}\left[ #1 \right]}
\newcommand{\var}[1]{\mathrm{var}\left( #1 \right)}
\newcommand{\cov}[1]{\mathrm{cov}\left( #1 \right)}
\newcommand{\diag}[1]{\mathrm{diag}\left( #1 \right)}
\newcommand{\trace}[1]{\mathrm{trace}\left( #1 \right)}
\newcommand{\card}[1]{\left| #1 \right|}
\newcommand{\myemph}[1]{\emph{\color{red}#1}}

%%============================================================================
\def\thesection{\arabic{section}}
%\def\thesubsection{\arabic{section}.\arabic{subsection}}
%\def\thesubsubsection{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}
%\def\thefigure{\arabic{figure}}
%\def\theequation{\arabic{equation}}
%\def\theexercice{\arabic{exercice}}
%\def\theexample{\arabic{example}}
%\def\theproof{\arabic{proof}}

%===============================================
\newtheorem{property}{Properties}
\newtheorem{remark}{Remark}
\newtheorem{theorem}{Theorem - \thetheoreme}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{lemme}{Lemme - \thelemme}
\newtheorem{proof}{Proof - \theproof}
\newenvironment{TAB}{\begin{table}[[hbt] \center \leavevmode}{\end{table}}
%%============================================================================
%\renewcommand\arraystretch{1.6}

\def\ua{\underline a}
\def\ub{\underline b}
\def\uB{\underline B}
\def\uH{\underline H}
\def\ur{\underline r}
\def\us{\underline s}
\def\ux{\underline x}
\def\uX{\underline X}
\def\uZ{\underline Z}
\def\utheta{\underline \theta}



\def\tn{\mathrm{TN}}
\def\fn{\mathrm{FN}}
\def\tp{\mathrm{TP}}
\def\fp{\mathrm{FP}}
\def\tpn{\mathrm{tPN}}
\def\tnn{\mathrm{tNN}}
\def\tdn{\mathrm{tDN}}

\def\precision{\mathrm{\color{red}Precision}}
\def\recall{\mathrm{\color{red}Recall}}
\def\fscore{{\color{red}F\mathrm{-score}}}
\def\far{\mathrm{FAR}}
\def\mdr{\mathrm{MDR}}
\def\vdr{\mathrm{VDR}}
\def\ci{\mathrm{CI}}
\def\pfa{P_{\mathrm{FA}}}
\def\pd{P_{\mathrm{D}}}
\def\loc{\mathrm{LOC}}

\def\SNR{\mathrm{SNR}}
\def\crb{\mathrm{CRB}}
\def\fim{\mathrm{FIM}}

\def\auc{\mathrm{AUC}}
\def\aec{\mathrm{aec}}



\def\void{{\small void}}
\def\nomeaning{{\small meaningless}}
\def\unknown{{\small unknown}}
\def\MSC{\mathrm{MSC}}
\def\hMSC{\widehat{\MSC}}%{\MSC}} 
\def\ellk{{k}}
\def\SOI{common signal part }
\def\absGamma{\Phi}

%============== colors ========================
\definecolor{enstrouge}{RGB}{212,65,84}
\definecolor{lightorange}{RGB}{235,226,52}
\definecolor{greennoise}{RGB}{243,42,255}
\definecolor{lightred}{RGB}{255,181,183}
\definecolor{light-grey}{rgb}{0.95,0.95,0.95}
\definecolor{peach}{rgb}{0.98,0.49,0.25}
\definecolor{burntorange}{rgb}{0.79,0.37,0}
\definecolor{light-yellow}{rgb}{1,1,0.92}

\definecolor{light-green}{RGB}{231,255,145}
\definecolor{enstorange}{RGB}{255,214,10}
\definecolor{enstrouge}{RGB}{212,65,84}
\definecolor{grey}{RGB}{204,204,204}
\definecolor{blue}{RGB}{0,0,255}
\definecolor{almost-black}{RGB}{100,100,100}
\definecolor{violet}{rgb}{0.4,0,0.4}
\definecolor{cyan}{RGB}{0,255,255}
\definecolor{magenta}{RGB}{243,42,255}

\def\degree{^{\circ}}
\def\simiid{\stackrel{\mathrm{i.i.d.}}{\sim}}
\def\simind{\stackrel{\mathrm{ind.}}{\sim}}

 
%%%============================================================================
%%\def\thesection{\arabic{section}}
%%\def\thefigure{\arabic{figure}}
%%\def\theequation{\arabic{equation}}
%%\def\theexercice{\arabic{exercice}}
%%\def\theequation{\arabic{exercice}.\arabic{equation}}
%%%============================================================================
%%\newcounter{auxiliaire}
%%%%%%%%% comment
%%\setcounter{auxiliaire}{\theenumi}
%%\end{enumerate}
%% TEXTE
%%\begin{enumerate}
%%\setcounter{enumi}{\theauxiliaire}
%%%============================================================================

 \bibliographystyle{plain} 

\begin{document}
 \sloppy
%=======================================================
%=======================================================


In this study we are interested by the station design in term of parameter accuracy, and more particularly of the azimuth. In short, in presence of only pure coherent acoustic waves, it is clear that the best design is to locate sensors at far as possible. For which reason could we take into account an upper bound on the aperture ? 

Regarding the size of the station and the distance of the source, a possible phenomena, which could induce a limitation on the station aperture in presence of a coherent acoustic signal, is that the loss of coherence (LOC) which usually increases when the distance between sensors increases.

For conducting this study the 3 points following program has been considered:
\begin{itemize}
 \item
choosing an index to evaluate the accuracy of the station. A commonly used index is the Cramer-Rao bound (CRB). Typically that depends on the geometry of the station, the level of noise and the LOC features. A summary of the CRB could be the area/volume of the confidence ellipsoid.

 \item
choosing features to characterize a geometry. We have retained (i) the isotropy and (ii) the uniform distribution of the inter-distances. The isotropy is easy to check and also it is simple to correct if necessary by adding 2 sensors (resp. 3) for 2D station (resp. 3D station).

We can not answer to the good effect or not of the inter-distance uniformity because that depends on the LOC model. Therefore we have to validate a such model.

\item
validating a LOC model.

The used LOC feature is the magnitude square coherence (MSC). This index has the interesting property to be between 0 and 1, and equal to 1 iff the two signals are spatially coherent.

	The approach to determine the LOC model is based on the observation analysis. It is conducted as it follows: we consider the station I37 which consists of 10 sensors with 45 uniformly disibuted inter-distances. We base the analysis on the presence of a quasi-permanent coherent acoustical signal, saying the microbarom, in a frequency bandwidth large enough between 0.05 to 3 Hz. 

For a given frequency, we select the portions of signals where the MSC is greater than 0.8 on the three nearest sensors and study the decay of the MSC along the inter-distance values.

\end{itemize}

\end{document}

\begin{remark}[on the noise]
Typical station aperture  is 2 km. Noise is mainly due to the wind.
\begin{itemize}
\item
Therefore we assume that the noises are spatially uncorrelated regarding the sensor inter-distances.
\item
On the other hand, we assume that the noise levels are identical on all sensors. Although that is not realistic, it is worth to notice that the noise level is not directly related to the inter-distances between sensors. It follows that, for the station design understanding, we can consider there is no loss of generalities to assume that.
\end{itemize}
\end{remark}

\begin{remark}[on the coherent source]
To be able to study the LOC, we need a permanent source. The microbarom plays this role in the following.
\end{remark}

\begin{remark}[on the isotropy]
In the absence of LOC, the station is isotrope iff 
\begin{eqnarray}
 \label{eq:isotropy-condition}
XX^{T}&\propto&I_{d}
\end{eqnarray}
where $X$ is $d\times M$ matrix whose the $m$-th colomun if the coordinates of the $m$-th sensor (in any  system of coordinates). 

It follows that  given an arbitrary array with $M$ sensors in $\mathds{R}^{d}$ it is always possible to complete with $d$ locations in such a way the new array is isotrope, i.e. verifies \eqref{eq:isotropy-condition}, see annex.

\end{remark}

\begin{remark}[on the geometry]
In the absence of LOC, we will see below that the best performances are associated with inter-distances as large as possible. In this case the maximization of the minimal distance leads to locate the sensors on a circle. But in this case the distribution of the distances is not uniform. It follows that in presence of LOC, several sensors are concern with the same LOC. It seems (it is not a proof) that a rule could be to locate the sensors in such a way that the distances are more uniform (see figure \ref{fig:uniforinterdistances}).

\figscale{../figures/uniforinterdistances.pdf}{Sensor locations with inter distances}{fig:uniforinterdistances}{0.9}

\end{remark}


\newpage\clearpage
%=======================================================
 \section{LOC model}
%=======================================================
%=======================================================
\subsection{Case of 2 sensors}
By definition, two signals arriving on a two different locations are said non-coherent signals, or called noises, if they are spatially uncorrelated. More specifically if $s_{1}(t)$ and $s_{2}(t)$ denote the respective stationary signals observed in to different locations, the coherence level is defined by the magnitude square coherence:
\begin{eqnarray*}
 \MSC(f)&=&\frac{|S_{12}(f)|^{2}}{S_{11}(f)S_{22}(f)}
\end{eqnarray*}
where $S_{11}(f)$ and $S_{22}(f)$ denote the spectral densities of $s_{1}(t)$ and $s_{2}(t)$, and $S_{12}(f)$ the cross-spectrum. It is well known that $\MSC(f)\leq 1$. 
\begin{definition}[coherence]
\label{def:coherence2sensors}
When $\MSC(f)=1$, we say that the 2 signals are perfectly coherent, elsewhere we speak about loss of coherence (LOC). 
\end{definition}


It is shown that the  $\MSC(f)$ between 2 signals is 1, if and only if it exists a filter, whose impulse respond is $g(t)$, such as $s_{1}(t)=g_{1}(t)\star s_{2}(t)$. A particular case is $g(t)=\delta(t-t_{0})$ relative to a pure delay.


  \medskip
 When $\MSC(f)=0$ we say that the 2 signals are spatially uncorrelated and are called noises.



%=======================================================
\subsection{Case of $M$ sensors}
We consider a station with $M$ sensors. There is only one acoustic source faraway from the station, in such a way it can be considered as planar wave. Therefore the $M$-ary signal  writes: 
\begin{eqnarray*}
x(t) & = & \underbrace{s(t;\theta)}_{\text{acoustic signal}}+ \underbrace{w(t)}_{\text{noise}}
\end{eqnarray*}
where $\theta$ denotes the 3D slowness vector. Under assumption of pure delay we can write for the $m$-th sensor located in $r_{m}$:
\begin{eqnarray}
\label{eq:mthentryofst}
s_{m}(t;\theta)&=&s(t-r_{m}^{T}\theta)
\end{eqnarray}
It follows  that, under the assumption  that $s(t)$ is stationary random process with spectral density $\gamma_{s}(f)$, the spectral matrix of the $M$-ary process $s(t)$, whose the $m$-th entry is \eqref{eq:mthentryofst}, writes:
\begin{eqnarray*}
\Gamma_{s}(f)&=&\gamma_{s}(f)d(f)d^{H}(f)
\end{eqnarray*}
where $d(f)$ is a $M$-ary vector whose the $m$-entry writes $e^{-2j\pi fr_{m}^{T}\theta}$. Clearly the matrix $\Gamma_{s}(f)$ is of rank 1, and that is the general definition of the coherence, in accordance with the definition \ref{def:coherence2sensors} for only 2 sensors. In any case, the matrix $\Gamma_{s}(f)\geq 0$ for any frequency $f$.
\begin{definition}[coherence]
\label{def:coherenceMsensors}
$M$ stationary signals are said spatially coherent if their spectral matrix is of rank 1, elsewhere we speak about LOC. 
\end{definition}

\begin{remark}
Coherence is not only restricted to the case of pure delays. Perfect coherence is also verified for filtering signals.
\end{remark}



%=======================================================
\subsection{Discrete domain}

All signals are real and sampled at the sampling frequency  $F_{s}=20$ Hz. After sampling we obtain $x_{n}=x(n/F_{s})$. For $k=0$ to $(N-1)$ we consider the $M$-ary discrete Fourier transform:
 \begin{eqnarray*}
 X_{k}&=&\frac{1}{\sqrt{N}}\sum_{n=0}^{N-1}x_{n}\,e^{-2j\pi n f_{k}}
    \quad\mathrm{where}\quad
 f_{k}=kF_{s}/N
 \end{eqnarray*}
We let $K=N/2$.
For $K$ great enough, $X_{1}$, $\ldots$, $X_{K}$ is a sequence of  $M$-ary independent circularly gaussian random vectors with zero-mean and respective covariance:
\begin{eqnarray}
\label{eq:spectralmatrixpuredelay}
\Gamma_{k}(\alpha)&=&\gamma_{k}d_{k}(\theta)d_{k}^{H}(\theta)+\sigma^{2}I_{M}
%\diag{\begin{matrix}\sigma_{1},\ldots,\sigma_{M}\end{matrix}}
\end{eqnarray}
where $d_{k}(\theta)$ is an $M$-ary vector whose the $m$-th entry writes $D_{k,m}=e^{-2j\pi f_{k} r_{m}^{T}\theta }$ and where $\gamma_{k}=\gamma_{s}(f_{k})$.

The expression \eqref{eq:spectralmatrixpuredelay} can be rewritten:
\begin{eqnarray}
\label{eq:spectralmatrixLOC}
\Gamma_{k}(\alpha)&=&\gamma_{k}D_{k}(\theta)\, C_{k}\,D_{k}^{H}(\theta)+\sigma^{2}I_{M}
%\diag{\begin{matrix}\sigma_{1},\ldots,\sigma_{M}\end{matrix}}
\end{eqnarray}
where $D_{k}(\theta)$ is an $M$-ary diagonal matrix whose the $m$-th diagonal entry writes $D_{k,m}=e^{-2j\pi f_{k} r_{m}^{T}\theta }$ and where $C_{k}=\mathds{1}\mathds{1}^{T}$ which is a rank 1 matrix. Under LOC, $C_{k}$ is no more a rank 1 projector.  A commonly used model for the LOC is for $1\leq \ell\leq M$ and $1\leq \ell'\leq M$:
\begin{eqnarray}
 \label{eq:CkwithGauss}
 C_{k,\ell\ell'} &=&e^{-2\pi^2f_k^2(r_{\ell}-r_{\ell'})^TS_{\theta}(r_{\ell}-r_{\ell'})}
\end{eqnarray}
where $S_{\theta}$ is a $3\times 3$ covariance matrix depending on 3 free parameters. In summary   we can write that:
\begin{eqnarray*}
 (X_{1},\ldots,X_{K}) &\sim&\prod_{k=1}^{K}\mathcal{N}_{c}(x_{k};0_{M},\Gamma_{k}(\alpha))
\end{eqnarray*}
and the likelihood writes:
\begin{eqnarray}
 \mathcal{L}(\alpha)&=&
 \sum_{k=1}^{K}\log\det\Gamma_{k}(\alpha)+\trace{\Gamma_{k}^{-1}(\alpha)X_{k}X_{k}^{T}}
\end{eqnarray}
where the parameter $\alpha$ consists of
\begin{eqnarray}
\alpha&=&
\{
\gamma_{1},\ldots,\gamma_{K},\theta_{1},\theta_{2},\theta_{3},S_{\theta},\sigma^{2}
\}
\in \mathds{R}^{+K}\times  \mathds{R}^{3}\times \mathcal{M}_{3}^{+}\times \mathds{R}^{+}
\end{eqnarray}
where $\mathcal{M}_{3}^{+}$ is the set of $3\times 3$ positive matrices. The size of $\alpha$ is $K+7$.


Another way is to characterize the slowness by azimuth, elevation and velocity and the LOC by the respective standard deviations of them, see expression \eqref{eq:theta2aec}.
%=======================================================
 \section{Validation}
%=======================================================
%=======================================================
Taking the log of expression \eqref{eq:CkwithGauss-2} we get:
\begin{eqnarray}
 \label{eq:logCkwithcauchy}
 \log C_{k,\ell\ell'} (\beta)&=& -\beta f_k^2 d_{\ell,\ell'}^2
\end{eqnarray}
meaning that the the log of MSC is proportional to the square to the frequency, and  to the distance. 

For the proportionality to the frequency, it is not obvious to test it because we don't dispose of a coherent signal in a large frequency bandwidth of interest. 


%=======================================================
 \section{Cramer-Rao bound (CRB)}
%=======================================================
%=======================================================
The $(\ell,\ell')$ entry of the Fisher information matrix  associated to the parameter $\alpha$ writes:
\begin{eqnarray}
 \label{eq:FIM}
\fim_{\ell,\ell'}(\alpha)&=&\sum_{k=1}^{K}\trace{\Gamma_{k}^{-1}\times\partial_{\ell}\Gamma_{k}\times\Gamma_{k}^{-1}\times\partial_{\ell'}\Gamma_{k}}
\end{eqnarray}
where $\ell,\ell'\in\{1,2,3,4\}$ and where $\partial_{\ell}\Gamma_{k}$ is the partial derivative w.r.t. $\theta_{1}$, $\theta_{2}$, $\theta_{3}$ and $\sigma^{2}$.  It is clear that the CRB terms relative to the correlation of $\theta$ and $\sigma^{2}$ are 0. We let:
\begin{eqnarray*}
 d_{k,\ell}(\theta)&=&
  \begin{bmatrix}
  -2j\pi f_{k} r_{1,\ell}\,e^{-2j\pi f_{k}r_{1}^{T}\theta}
  \\
  \vdots
  \\
  -2j\pi f_{k} r_{M,\ell}\,e^{-2j\pi f_{k}r_{M}^{T}\theta}
  \end{bmatrix}
\end{eqnarray*}
Then for $\ell=1,2,3$:
\begin{eqnarray*}
\partial_{\ell}\Gamma_{k}&=&\gamma_{k}
   \diag{d_{k,\ell}(\theta)}C_{k}(\beta)D_{k}^{H}(\theta)+
   D_{k}(\theta)C_{k}(\beta) \diag{d_{k,\ell}(\theta)}^{H}
   \\
   &=&2\, \mathcal{R}\left(
   \diag{d_{k,\ell}(\theta)}C_{k}(\beta)D_{k}^{H}(\theta)\right)
\end{eqnarray*}
It is worth to notice that, if $\beta\approx +\infty$, $C_{k}=I_{M}$ and $\partial_{\ell}\Gamma_{k}=0$ which is normal because in this case $\Gamma_{k}$ does not depend on $\theta$. For the derivation w.r.t. $\sigma^{2}$ we have:
\begin{eqnarray*}
\partial_{4}\Gamma_{k}&=&I_{M}
\end{eqnarray*}
A direct consequence is that the FIM is of this shape:
\begin{eqnarray*}
 \fim&=&\begin{bmatrix}
 F_{123}&0_{3,1}&0_{3,K}
 \\
 0_{1,3}&f_{\sigma^{2}}&?
 \\
 0_{K,3}&?&F_{\gamma,K,K}
 \end{bmatrix}
\end{eqnarray*}
Because the CRB on the estimation of $\theta$ is given by the $3\times 3$ matrix of the inverse of $\fim$ and because the correlations with other parameter estimates are 0, we are only concern with $ F_{123}$ by taking $ F_{123}^{-1}$ . Then the CRB w.r.t. the azimuth, elevation and velocity can be derived using the Jacobian of the one-to-one mapping between the slowness and the vector $(a,e,c)$ where $a$, $e$ and $c$ denote respectively the azimut, the elevation and the velocity. The same calculation can be used to derive the CRB w.r.t. the azimuth and the trace velocity.


%=======================================================
%=======================================================
\appendix
\chapter{Transform an array in isotrope array}
We consider an arbitrary  array whose locations are given by:
\begin{eqnarray*}
X&=&\begin{bmatrix}
x_{1,1}&\ldots&x_{1,M}
\\
x_{2,1}&\ldots&x_{2,M}
\\
x_{3,1}&\ldots&x_{3,M}
\end{bmatrix}
\end{eqnarray*}
It follows that
\begin{eqnarray*}
 XX^{T}&=&
 \sum_{i=1}^{d}\mu_{i}\xi_{i}\xi^{T}_{i}
\end{eqnarray*}
where $0\leq \mu_{i}\leq \alpha_{0}$. The new array writes
\begin{eqnarray*}
Y &=& \begin{bmatrix}
X&\sqrt{(\alpha_{0}-\mu_{1})}\xi_{1}&\sqrt{(\alpha_{0}-\mu_{2})}\xi_{2}&\sqrt{(\alpha_{0}-\mu_{3})}\xi_{3}
\end{bmatrix}
\end{eqnarray*}
It is easy to verify that $YY^{T}=\alpha_{0}I_{d}$.

%=======================================================
%=======================================================
\chapter{Coherence}
The LOC is modeled by the random slowness:
\begin{eqnarray*}
\Theta &=& \theta_0+\epsilon
\end{eqnarray*}
where $\theta_0$ is a 3D deterministic vector and $\epsilon$ a 3D random vector with zero-mean and distribution probability density denoted $p_{\epsilon}$. The spectral matrix of the $M$-ary random vectors associated to the sensor locations has the following entry:
\begin{eqnarray*}
S_{\ell,\ell'}(f) &=& \gamma(f)\int_{\mathds{R}^3}e^{-2j\pi f (r_{\ell}-r_{\ell'})^Tt}p_{e}(t-\theta_0)dt
\\
&=&\gamma(f)
e^{-2j\pi f (r_{\ell}-r_{\ell'})^T\theta_0}
\int_{\mathds{R}^3}e^{-2j\pi f (r_{\ell}-r_{\ell'})^Tt}p_{e}(t)dt
\\
&=&\gamma(f)
e^{-2j\pi f (r_{\ell}-r_{\ell'})^T\theta_0}\times
\Phi_{e}(2\pi f(r_{\ell}-r_{\ell'}))
\end{eqnarray*}
where $\Phi_{e}(v)$ denotes the characteristic function of the r.v. $e$. The deterministic case where $\epsilon=0$ leads to:
\begin{eqnarray*}
S_{\ell,\ell'}(f) &=& \gamma(f)e^{-2j\pi f (r_{\ell}-r_{\ell'})^T\theta_0}
\end{eqnarray*}
and therefore $S(f)=d(f)d^H(f)$ where $d$ is a complex vector whose the $\ell$-entry writes $e^{-2j\pi f r_{\ell}^T\theta_0}$. Hence $S$ is a projector of rank 1 and corresponds to a pure coherent case.

In the general case:
\begin{eqnarray*}
 S(f) &=& \gamma_s(f)D(f)C(f)D^H(f)
\end{eqnarray*}
$D(f)$ is a diagonal matrix whose the $\ell$-th diagonal entry is $e^{-2j\pi f r_{\ell}^T\theta_0}$ and $C(f)$ a matrix whose the $(\ell,\ell')$-entry writes:
\begin{eqnarray*}
 C_{\ell,\ell'}(f) &=& \Phi_{e}(2\pi f(r_{\ell}-r_{\ell'}))
\end{eqnarray*}

If $\epsilon$ is gaussian with covariance matrix $\Sigma_{\theta}$:
\begin{eqnarray*}
 \Phi_{e}(2\pi f(r_{\ell}-r_{\ell'}))&=& e^{-2\pi^2f^2 (r_{\ell}-r_{\ell'})^T\Sigma_{\theta}(r_{\ell}-r_{\ell'})}
\end{eqnarray*}
$\Sigma_{\theta}$ depends on 6 free parameters. 

\begin{remark}[Unities]
the covariance matrix $\Sigma_{\theta}$ is in s$^2$/m$^2$. It follows that $f^2 \Sigma_{\theta}$ is homogeneous at the inverse of the wavelength square.
\end{remark}


Using \eqref{eq:jacobianaec2theta}, we can derive an expression in term of azimuth $a$, elevation $e$ and velocity $c$. We have:
\begin{eqnarray}
\label{eq:theta2aec}
\Sigma_{\theta}=J\,\Sigma_{\aec}\,J^{T}
\end{eqnarray}
Then
\begin{eqnarray*}
 \log \Phi_{e}(2\pi f(r_{\ell}-r_{\ell'}))&=& 
-2\pi^2\frac{f^2}{c^2} (r_{\ell}-r_{\ell'})^TK(a,e,c)\Sigma_{\aec}K^T(a,e,c)(r_{\ell}-r_{\ell'})
\\
&=&
-2\pi^2(\rho_{\ell}-\rho_{\ell'})^TK_{\aec}\Sigma_{\aec}K^T_{\aec}(\rho_{\ell}-\rho_{\ell'})
\end{eqnarray*}
where $\rho=r/\lambda$ with $\lambda=c/f$ and
\begin{eqnarray*}
K_{\aec}&=&
\begin{bmatrix}
\cos(a)\cos(e)&\sin(a)\sin(e)&c^{-1}\sin(a)\cos(e)
\\
-\sin(a)\cos(e)&-\cos(a)\sin(e)&-c^{-1}\cos(a)\cos(e)
\\
0&\cos(e)&-c^{-1}\sin(e)
\end{bmatrix}
\end{eqnarray*}
A simple case is if we take $\Sigma_{\aec}$ diagonal and hence depending on only 3 free parameters. 







%=======================================================
%=======================================================
\chapter{One-to-one mappings and Jacobians}
%=======================================================
\subsubsection{$\theta$ to $(a,e,c)$ }
If we consider the one-to-one mapping $\theta$ to $(a,e,c)$ in $(0,2\pi)\times(-\pi/2,\pi/2)\times\mathds{R}^+$, we can write:
\begin{eqnarray*}
\begin{array}{cc}
 \left\{
 %\renewcommand\arraystretch{1.2}
 \begin{array}{ll}
 \theta_{1}=-c^{-1} \sin(a)\cos(e)&\, \theta_{1}\in\mathds{R}
 \\
 \theta_{2}=c^{-1}  \cos(a)\cos(e)&\,\theta_{2}\in\mathds{R}
 \\
 \theta_{3}=c^{-1}\sin(e)&\, \theta_{3}\in\mathds{R}
 \end{array}\right.
&
 \left\{
 \begin{array}{ll}
 a=\arg(\theta_{2}-j \theta_{1})& \, a\in(0,2\pi)
  \\
e=\arg\sin(c\theta_{3})& \,e\in(-\pi/2,\pi/2)
 \\
 c=(\theta_{1}^{2}+ \theta_{2}^{2}+ \theta_{3}^{2})^{-1/2}& \, c \geq 0
 \end{array}\right.
\end{array}
\end{eqnarray*}
whose the Jacobian is
\begin{eqnarray}
 \label{eq:jacobianaec2theta}
 J(a,e,c)
&= &
 \begin{bmatrix}
-c^{-1}\cos(a)\cos(e)&c^{-1}\sin(a)\sin(e)&c^{-2}\sin(a)\cos(e)
\\
-c^{-1}\sin(a)\cos(e)&-c^{-1}\cos(a)\sin(e)&-c^{-2}\cos(a)\cos(e)
\\
0&c^{-1}\cos(e)&-c^{-2}\sin(e)
\end{bmatrix}
\\
&=&\nonumber
c^{-1}
\begin{bmatrix}
\cos(a)\cos(e)&\sin(a)\sin(e)&c^{-1}\sin(a)\cos(e)
\\
-\sin(a)\cos(e)&-\cos(a)\sin(e)&-c^{-1}\cos(a)\cos(e)
\\
0&\cos(e)&-c^{-1}\sin(e)
\end{bmatrix}
\\
&=&\nonumber
c^{-1}K_{\aec}
\end{eqnarray}

\subsubsection{$\theta$ to $(a,e,v)$ }
If we consider the one-to-one mapping $\theta$ to $(a,e,v)$ in $(0,2\pi)\times(-\pi/2,\pi/2)\times\mathds{R}^+$, we can write:
\begin{eqnarray*}
\begin{array}{cc}
 \left\{
 %\renewcommand\arraystretch{1.2}
 \begin{array}{ll}
 \theta_{1}=-v^{-1} \sin(a)&\, \theta_{1}\in\mathds{R}
 \\
 \theta_{2}=v^{-1}  \cos(a)&\,\theta_{2}\in\mathds{R}
 \\
 \theta_{3}=v^{-1}\tan(e)&\, \theta_{3}\in\mathds{R}
 \end{array}\right.
&
 \left\{
 \begin{array}{ll}
 a=\arg(\theta_{2}-j \theta_{1})& \, a\in(0,2\pi)
  \\
e=\arg\tan(v\theta_{3})& \,e\in(-\pi/2,\pi/2)
 \\
 v=(\theta_{1}^{2}+ \theta_{2}^{2})^{-1/2}& \, c \geq 0
 \end{array}\right.
\end{array}
\end{eqnarray*}
whose the Jacobian is
\begin{equation}
 \label{eq:jacobianaecv2theta}
 J(a,e,v)
 = 
 \begin{bmatrix}
-v^{-1}\cos(a)&0&v^{-2}\sin(a)
\\
-v^{-1}\sin(a)&0&-v^{-2}\cos(a)
\\
0&v^{-1}/\cos^2(e)&-v^{-2}\tan(e)
\end{bmatrix}
\end{equation}
%=======================================================
%=======================================================
\chapter{Estimation of parameters}
%=======================================================
we have 
\begin{eqnarray*}
 \log C_{k,m,m'} &=&-2\pi^{2} f_{k}^{2}(r_{m}-r_{m'})^{T}\Gamma(r_{m}-r_{m'})
 \\
 &=&
-2\pi^{2} f_{k}^{2}(r_{m,1}-r_{m',1})^{2}\Gamma_{11}
-2\pi^{2} f_{k}^{2}(r_{m,2}-r_{m',2})^{2}\Gamma_{22}
-4\pi^{2} f_{k}^{2}(r_{m,1}-r_{m',1})(r_{m,2}-r_{m',2})\Gamma_{12}
\\
&=&
\mu_{1}(k,m,m')\Gamma_{11}
+\mu_{2}(k,m,m')\Gamma_{22}
+2\mu_{3}(k,m,m')\Gamma_{12}
\end{eqnarray*}
Enumerating $k=1:K$, $m=1:M$, $m'=1:M$ with $m'>m$ leads to $KM(M-1)/2$ equations with 3 unknowns.


\end{document}

